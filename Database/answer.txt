
21. 홈팀이 3점 이상 차이로 승리한 경기의 경기장 이름, 경기 일 정, 홈팀 이름과 원정팀 이름 정보를 출력
SELECT STADIUM.STADIUM_NAME, SCHEDULE.SCHE_DATE, HT.TEAM_NAME, AT.TEAM_NAME
FROM SCHEDULE
JOIN STADIUM ON STADIUM.STADIUM_ID = SCHEDULE.STADIUM_ID
JOIN TEAM AT ON SCHEDULE.AWAYTEAM_ID = AT.TEAM_ID
JOIN TEAM HT ON SCHEDULE.HOMETEAM_ID = HT.TEAM_ID
WHERE (SCHEDULE.HOME_SCORE - SCHEDULE.AWAY_SCORE) >= 3;

22. 스케줄 테이블에서 경기장 이름, 홈팀 이름, 어웨이팀 이름을 출력하시오.
SELECT SCHEDULE.*, STADIUM.STADIUM_NAME, HT.TEAM_NAME, AT.TEAM_NAME
FROM SCHEDULE
    JOIN STADIUM ON SCHEDULE.STADIUM_ID = STADIUM.STADIUM_ID
    JOIN TEAM HT ON HT.TEAM_ID = SCHEDULE.HOMETEAM_ID
    JOIN TEAM AT ON SCHEDULE.AWAYTEAM_ID = AT.TEAM_ID;

23. 날짜별 경기수를 출력하시오. 단 누락된 날짜가 없게 하시오
WITH RECURSIVE DATES(DATE) AS
(
   SELECT CAST(MIN(SCHE_DATE) AS DATE)
    FROM SCHEDULE
    UNION ALL
    SELECT DATE + INTERVAL 1 DAY
    FROM DATES
    WHERE DATE + INTERVAL 1 DAY <= '2012-09-11'
)
SELECT DATES.DATE, COALESCE(COUNT(SCHEDULE.SCHE_DATE), 0)
FROM DATES LEFT JOIN SCHEDULE ON DATES.DATE = SCHEDULE.SCHE_DATE
GROUP BY DATES.DATE
ORDER BY DATES.DATE;

24. 선수들의 평균 키보다 작은 선수들의 이름, 포지션, 백넘버를 출력
SELECT PLAYER_NAME, POSITION, BACK_NO FROM PLAYER WHERE HEIGHT < ( SELECT AVG(HEIGHT) FROM PLAYER);

25. 정현수 선수의 소속팀의 연고지명, 팀명, 영문팀명을 출력
SELECT REGION_NAME, TEAM_NAME, E_TEAM_NAME
FROM TEAM
WHERE TEAM_ID IN ( SELECT TEAM_ID FROM PLAYER WHERE PLAYER_NAME = '정현수');

26. 각 팀에서 제일 키가 작은 선수들의 팀아이디, 선수명, 포지 션, 백넘버, 키를 출력
SELECT TEAM_ID, PLAYER_NAME, POSITION, BACK_NO, HEIGHT FROM PLAYER
WHERE (TEAM_ID, HEIGHT) IN (SELECT TEAM_ID, MIN(HEIGHT) FROM PLAYER GROUP BY TEAM_ID);

27. 포지션이 GK인 선수들을 검색(연관 서브쿼리 사용)
SELECT TEAM_ID, PLAYER_NAME, POSITION, BACK_NO, HEIGHT
FROM PLAYER X WHERE EXISTS( SELECT * FROM PLAYER Y WHERE X.PLAYER_ID = Y.PLAYER_ID AND Y.POSITION = 'GK');

28. 브라질 혹은 러시아 출신 선수가 있는 팀을 검색(연관 서브커 리 사용), 팀아이디, 팀명을 출력
SELECT TEAM_ID, TEAM_NAME FROM TEAM T WHERE TEAM_ID = ANY ( SELECT TEAM_ID FROM PLAYER P WHERE T.TEAM_ID = P.TEAM_ID AND ( P.NATION = '브라질' OR P.NATION = '러시아'));

29. 20120501부터 20120502 사이에 경기가 열렸던 경기장을 조회(연관 서브쿼리 사용), 경기장아이디, 경기장명을 출력
SELECT STADIUM_ID, STADIUM_NAME FROM STADIUM WHERE STADIUM_ID IN (SELECT STADIUM_ID FROM SCHEDULE WHERE SCHE_DATE BETWEEN '20120501' AND '20120502');

30. 각 팀에서 제일 키가 큰 선수들의 팀 아이디, 이름, 키를 출력
SELECT TEAM_ID, PLAYER_NAME, HEIGHT
FROM PLAYER
WHERE (TEAM_ID, HEIGHT) IN (SELECT TEAM_ID, MAX(HEIGHT) FROM PLAYER GROUP BY TEAM_ID);

31. 소속 팀의 평균 키보다 작은 선수들의 팀 아이디, 이름, 포지 션, 백넘버, 키를 출력
SELECT TEAM_ID, PLAYER_NAME, POSITION, BACK_NO, HEIGHT
FROM PLAYER X
WHERE HEIGHT < (
SELECT AVG(Y.HEIGHT)
FROM PLAYER Y
WHERE X.TEAM_ID = Y.TEAM_I)
ORDER BY X.TEAM_ID, HEIGHT, PLAYER_NAME;

32. 팀 아이디, 선수명, 키, 소속 팀의 평균키를 출력
SELECT TEAM_ID, PLAYER_NAME, HEIGHT, (SELECT AVG(HEIGHT) FROM PLAYER X WHERE X.TEAM_ID = Y.TEAM_ID) FROM PLAYER Y;

33. 팀 아이디, 팀명, 팀 인원수를 출력
SELECT TEAM_ID, TEAM_NAME, (SELECT COUNT(PLAYER_ID) FROM PLAYER X WHERE X.TEAM_ID = Y.TEAM_ID) FROM TEAM Y;

34. 팀 아이디, 팀명, 각 팀의 마지막 경기가 진행된 날짜를 출력
SELECT TEAM_ID, TEAM_NAME, (
    SELECT MAX(SCHE_DATE)
    FROM SCHEDULE X
    WHERE X.HOMETEAM_ID = Y.TEAM_ID OR X.AWAYTEAM_ID = Y.TEAM_ID
)
FROM TEAM Y;

35. 포지션이 MF인 선수들의 소속팀명 및 선수이름과 백넘버를 출력
SELECT TEAM.TEAM_NAME, PLAYER.PLAYER_NAME, PLAYER.BACK_NO FROM TEAM JOIN PLAYER ON TEAM.TEAM_ID = PLAYER.TEAM_ID WHERE PLAYER.POSITION = 'MF';

36. 키가 제일 큰 5명의 선수들의 이름, 포지션, 백넘버를 출력
SELECT PLAYER_NAME, POSITION, BACK_NO FROM PLAYER ORDER BY HEIGHT DESC LIMIT 5;

37. K02 팀의 평균키보다 평균키가 작은 팀의 이름과 해당 팀의 평균키를 출력
SELECT T.TEAM_ID, T.TEAM_NAME, AVG(P.HEIGHT) FROM PLAYER P JOIN TEAM T ON P.TEAM_ID = T.TEAM_ID GROUP BY T.TEAM_ID, T.TEAM_NAME HAVING AVG(P.HEIGHT) < (SELECT AVG(HEIGHT) FROM PLAYER WHERE TEAM_ID = 'K02');

38. 각 팀의 최종 경기일을 검색하시오. 단, 경기가 없던 팀은 제외하시오.
SELECT Y.TEAM_ID, MAX(S.SCHE_DATE)  FROM TEAM Y JOIN SCHEDULE S ON Y.TEAM_ID = S.AWAYTEAM_ID OR Y.TEAM_ID = S.HOMETEAM_ID GROUP BY Y.TEAM_ID;

39. 각 팀에 대해 최고 점수차로 이긴 게임의 상대팀 아이디, 게 임이 여린 날짜와 경기장 아이디, 점수차 및 경기 점수를 검색하시오. 단, 최고 점수차로 이긴 게임이 2개 이상이면 모두 나열하시오. 또한 경기 점수는 '이긴팀 점수:진팀 점수'로 표현하시오.


40. GK가 4인 이상 있는 팀의 팀명과 GK 선수의 인원수, 팀 전 체 선수의 인원수를 검색하시오

41. 홈에서 진 적이 없는 팀을 검색하시오. 단, 홈 경기가 없던 팀 은 제외하시오.
42. 각 팀의 승리 게임수, 무승부 게임수, 패배 게임수, 그리고 팀 의 전체 게임수를 검색하시오. 단, 점수가 없는 경기는 실제 진행되지 않았으므로 게임수에서 제외하시오